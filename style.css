/* Import Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Creepster&family=Nosifer&family=Bangers&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    overflow: hidden;
    font-family: 'Arial', sans-serif;
    position: relative; /* Ensure body is a positioning context */
}

.bg-animated {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
    pointer-events: none;
    background: linear-gradient(120deg, #1a0826 0%, #2d1b3d 30%, #3a1852 60%, #4b206b 80%, #1a0826 100%);
    background-size: 200% 200%;
    animation: gradientMove 12s ease-in-out infinite;
}

@keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.bg-waves {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 1;
    pointer-events: none;
    opacity: 0.18;
    mix-blend-mode: lighten;
    animation: wavesMove 18s linear infinite alternate;
}

@keyframes wavesMove {
    0% { transform: translateY(0) scaleX(1); }
    100% { transform: translateY(-30px) scaleX(1.03); }
}

.forest-container {
    position: fixed; /* Changed to fixed to prevent layout shift */
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    z-index: 2;
}

/* Moon */
.moon {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -65%);
    width: 75vw;
    height: 75vw;
    max-width: 75vh;
    max-height: 75vh;
    min-width: 400px;
    min-height: 400px;
    background: radial-gradient(circle at 60% 40%, #fffbe6 70%, #ffe680 100%);
    border-radius: 50%;
    box-shadow: 0 0 120px 40px rgba(255, 255, 200, 0.25), 0 0 200px 80px #fffbe6;
    overflow: hidden;
    z-index: 3;
    opacity: 0;
    transition: top 3s cubic-bezier(0.4, 0, 0.2, 1), opacity 2s ease-in;
}

.moon.rise {
    top: 120%;
}

.moon.visible {
    top: 50%;
    opacity: 1;
}

.moon-crater {
    position: absolute;
    background: rgba(180, 180, 150, 0.22);
    border-radius: 50%;
    filter: blur(1.5px);
    opacity: 0.7;
}

.crater1 { width: 12%; height: 10%; left: 18%; top: 32%; }
.crater2 { width: 8%; height: 7%; left: 60%; top: 20%; }
.crater3 { width: 6%; height: 5%; left: 40%; top: 60%; }
.crater4 { width: 10%; height: 8%; left: 70%; top: 55%; }
.crater5 { width: 7%; height: 6%; left: 30%; top: 48%; }
.crater6 { width: 5%; height: 4%; left: 55%; top: 38%; }
.crater7 { width: 4%; height: 3%; left: 50%; top: 25%; }

/* Grass */
.grass {
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100vw;
    height: 18vh;
    z-index: 7;
    background: linear-gradient(180deg, #1a3a1a 0%, #0d2b0d 40%, #081808 100%);
    border-top-left-radius: 60vw 10vh;
    border-top-right-radius: 60vw 10vh;
    box-shadow: 0 -10px 40px 10px #1b2e1d;
    overflow: hidden;
}

.grass::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: linear-gradient(90deg, transparent 0%, rgba(30, 70, 30, 0.3) 50%, transparent 100%),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(20, 50, 20, 0.2) 2px, rgba(20, 50, 20, 0.2) 4px);
    pointer-events: none;
}

/* Witch */
.witch {
    position: absolute;
    z-index: 5;
    left: 50%;
    top: 40%;
    width: 18vw;
    min-width: 120px;
    max-width: 260px;
    height: auto;
    pointer-events: none;
    filter: drop-shadow(0 4px 12px #0008);
    transform: translate(-50%, -60%);
    opacity: 0;
    transition: left 3s cubic-bezier(0.4, 0, 0.2, 1), opacity 1.5s ease-in;
}

.witch.enter {
    left: 120%;
}

.witch.visible {
    left: 50%;
    opacity: 1;
}

/* Dog */
.dog {
    position: absolute;
    z-index: 9;
    bottom: 12vh;
    width: 12vw;
    min-width: 80px;
    max-width: 180px;
    height: auto;
    pointer-events: none;
    filter: drop-shadow(0 2px 8px #000a);
    transition: left 7s linear, transform 0.3s;
}

/* Dog Light */
.dog-light {
    position: absolute;
    pointer-events: none;
    z-index: 8;
    left: 50%;
    border-radius: 20%;
    bottom: 12vh;
    width: 6vw;
    min-width: 120px;
    max-width: 260px;
    height: 3vw;
    max-height: 300px;
    transform: translate(-50%, 0);
    filter: blur(8px);
    opacity: 0.45;
    background: radial-gradient(ellipse at 50% 80%, #fffbe668 0%, #ffe68063 40%, #ffec806b 60%, #fff0 100%);
    transition: left 7s linear, transform 0.3s;
}

/* Castle */
.castle {
    position: absolute;
    left: 0;
    bottom: 2vh;
    z-index: 8;
    width: 40vw;
    height: auto;
    pointer-events: none;
    user-select: none;
    opacity: 0;
    transform: translateY(40px) scale(0.95);
    transition: opacity 1.2s cubic-bezier(0.4, 1, 0.4, 1), transform 1.2s cubic-bezier(0.4, 1, 0.4, 1);
}

.castle.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
}

/* Tree Right */
.tree-right {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 7;
    width: 18vw;
    min-width: 120px;
    max-width: 300px;
    height: auto;
    pointer-events: none;
    user-select: none;
}

/* Ghost */
.ghost-float {
    position: absolute;
    z-index: 8;
    bottom: 24vh;
    width: 6vw;
    min-width: 60px;
    max-width: 120px;
    height: auto;
    pointer-events: none;
    user-select: none;
    transition: left 7s linear, transform 0.3s;
}

/* Eyes */
.eyes-under {
    position: absolute;
    z-index: 9;
    pointer-events: none;
    left: 0;
    bottom: 0;
    width: 100vw;
    height: 18vh;
}

.eyes-blink {
    position: absolute;
    display: flex;
    gap: 8px;
    align-items: center;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.eyes-blink.visible {
    opacity: 1;
}

.eye-dot {
    width: 18px;
    height: 12px;
    border-radius: 50% 50% 60% 60% / 60% 60% 100% 100%;
    background: radial-gradient(ellipse at 60% 60%, #ff3b3b 70%, #a10000 100%);
    box-shadow: 0 0 8px 2px #ff3b3b, 0 0 18px 6px #a10000;
    position: relative;
    transition: all 0.15s ease-in-out;
    animation: eyeGlow 2s ease-in-out infinite;
}

@keyframes eyeGlow {
    0%, 100% {
        box-shadow: 0 0 8px 2px #ff3b3b, 0 0 18px 6px #a10000;
        filter: brightness(1);
    }
    50% {
        box-shadow: 0 0 12px 4px #ff3b3b, 0 0 24px 10px #a10000;
        filter: brightness(1.3);
    }
}

.eye-dot::after {
    content: '';
    position: absolute;
    left: 60%;
    top: 35%;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: #fff8;
    opacity: 0.7;
    filter: blur(0.5px);
}

.eye-dot.blink {
    height: 2px;
    animation: none;
    box-shadow: none;
}

.eye-dot.purple {
    background: radial-gradient(ellipse at 60% 60%, #b83bff 70%, #6a0099 100%);
    box-shadow: 0 0 8px 2px #b83bff, 0 0 18px 6px #6a0099;
}

.eye-dot.purple:not(.blink) {
    animation: eyeGlowPurple 2s ease-in-out infinite;
}

@keyframes eyeGlowPurple {
    0%, 100% {
        box-shadow: 0 0 8px 2px #b83bff, 0 0 18px 6px #6a0099;
        filter: brightness(1);
    }
    50% {
        box-shadow: 0 0 12px 4px #b83bff, 0 0 24px 10px #6a0099;
        filter: brightness(1.3);
    }
}

.eye-dot.yellow {
    background: radial-gradient(ellipse at 60% 60%, #ffeb3b 70%, #ff9800 100%);
    box-shadow: 0 0 8px 2px #ffeb3b, 0 0 18px 6px #ff9800;
}

.eye-dot.yellow:not(.blink) {
    animation: eyeGlowYellow 2s ease-in-out infinite;
}

@keyframes eyeGlowYellow {
    0%, 100% {
        box-shadow: 0 0 8px 2px #ffeb3b, 0 0 18px 6px #ff9800;
        filter: brightness(1);
    }
    50% {
        box-shadow: 0 0 12px 4px #ffeb3b, 0 0 24px 10px #ff9800;
        filter: brightness(1.3);
    }
}

/* Pumpkin Group */
.pumpkin-group {
    position: absolute;
    right: 2vw;
    bottom: 2vh;
    z-index: 7;
    width: 18vw;
    min-width: 120px;
    max-width: 320px;
    height: auto;
    pointer-events: none;
    user-select: none;
    opacity: 0;
    transform: translateY(40px) scale(0.95);
    transition: opacity 1.2s cubic-bezier(0.4, 1, 0.4, 1), transform 1.2s cubic-bezier(0.4, 1, 0.4, 1);
}

.pumpkin-group.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
}

/* Bat */
.bat-fly {
    position: absolute;
    left: 50vw;
    top: 20vh;
    width: 7vw;
    min-width: 48px;
    max-width: 120px;
    height: auto;
    z-index: 10;
    pointer-events: none;
    user-select: none;
    transition: left 2.2s cubic-bezier(0.4, 1, 0.4, 1), top 2.2s cubic-bezier(0.4, 1, 0.4, 1),
        transform 2.2s cubic-bezier(0.4, 1, 0.4, 1), width 2.2s cubic-bezier(0.4, 1, 0.4, 1);
    will-change: left, top, transform, width;
}

/* Wibu Ground */
.wibu-ground {
    position: absolute;
    left: 50%;
    bottom: 18vh;
    transform: translateX(-50%) translateY(0);
    width: 13vw;
    min-width: 110px;
    max-width: 240px;
    height: 2.2vw;
    min-height: 18px;
    max-height: 38px;
    background: linear-gradient(180deg, #2d1b3d 0%, #181818 100%);
    border-radius: 50% 50% 60% 60% / 60% 60% 100% 100%;
    box-shadow: 0 6px 18px 0 #000a, 0 0 0 2px #0008;
    z-index: 8;
    pointer-events: none;
    user-select: none;
    transition: transform 1.2s cubic-bezier(0.4, 1, 0.4, 1);
}

/* Wibu Image */
.wibu-img {
    position: absolute;
    left: 50%;
    bottom: 18vh;
    transform: translateX(-50%) translateY(0);
    z-index: 9;
    width: 12vw;
    min-width: 100px;
    max-width: 220px;
    height: auto;
    pointer-events: none;
    user-select: none;
    transition: transform 1.2s cubic-bezier(0.4, 1, 0.4, 1);
}

/* Modal */
.halloween-modal {
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(20, 10, 30, 0.92);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease-in-out;
}

.halloween-modal.hide {
    opacity: 0;
    pointer-events: none;
}

.halloween-modal-content {
    background: #2d1b3d;
    border-radius: 18px;
    box-shadow: 0 8px 40px #000a;
    padding: 48px 36px 36px 36px;
    text-align: center;
    min-width: 320px;
    max-width: 90vw;
    position: relative;
}

.halloween-title {
    font-family: 'Creepster', 'Nosifer', 'Bangers', 'Arial Black', cursive, sans-serif;
    color: #ff9800;
    font-size: 3.2rem;
    letter-spacing: 0.15em;
    margin-bottom: 32px;
    text-shadow: 0 4px 24px #000, 0 0 12px #ff9800cc;
}

.halloween-play-btn {
    font-family: inherit;
    font-size: 1.5rem;
    background: linear-gradient(90deg, #ff9800 0%, #ff5722 100%);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 16px 48px;
    cursor: pointer;
    box-shadow: 0 2px 12px #0006;
    transition: background 0.2s, transform 0.2s;
}

.halloween-play-btn:hover {
    background: linear-gradient(90deg, #ff5722 0%, #ff9800 100%);
    transform: scale(1.07);
}